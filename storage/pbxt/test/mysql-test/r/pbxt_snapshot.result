CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE=innodb;
CREATE TABLE t2 (a INT PRIMARY KEY) ENGINE=pbxt;
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
BEGIN;
SELECT * FROM t1;
a
BEGIN;
INSERT INTO t1 VALUES (1);
COMMIT;
BEGIN;
INSERT INTO t2 VALUES (1);
COMMIT;
SELECT * FROM t1;
a
SELECT * FROM t2;
a
1
COMMIT;
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION WITH CONSISTENT SNAPSHOT;
SELECT * FROM t1;
a
1
BEGIN;
INSERT INTO t1 VALUES (2);
COMMIT;
BEGIN;
INSERT INTO t2 VALUES (2);
COMMIT;
SELECT * FROM t1;
a
1
SELECT * FROM t2;
a
1
COMMIT;
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE=pbxt;
CREATE TABLE t2 (a INT PRIMARY KEY) ENGINE=innodb;
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
BEGIN;
SELECT * FROM t1;
a
BEGIN;
INSERT INTO t1 VALUES (1);
COMMIT;
BEGIN;
INSERT INTO t2 VALUES (1);
COMMIT;
SELECT * FROM t1;
a
SELECT * FROM t2;
a
1
COMMIT;
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION WITH CONSISTENT SNAPSHOT;
SELECT * FROM t1;
a
1
BEGIN;
INSERT INTO t1 VALUES (2);
COMMIT;
BEGIN;
INSERT INTO t2 VALUES (2);
COMMIT;
SELECT * FROM t1;
a
1
SELECT * FROM t2;
a
1
COMMIT;
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1 (i INT) ENGINE=PBXT;
SELECT * FROM t1;
i
START TRANSACTION WITH CONSISTENT SNAPSHOT;
INSERT INTO t1 VALUES (1);
ROLLBACK;
SELECT * FROM t1;
i
DROP TABLE t1;
